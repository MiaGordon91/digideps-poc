{%  extends "base.html.twig" %}
{% block body %}
        <!--Load the AJAX API-->
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript">

            // Load the Visualization API and the corechart package.
            google.charts.load('current', {'packages':['corechart']});

            // Set a callback to run when the Google Visualization API is loaded.
            google.charts.setOnLoadCallback(drawChart);

            // Callback that creates and populates a data table,
            // instantiates the pie chart, passes in the data and
            // draws it.

            function drawChart() {

                let categoryData = {{ categorySummary | json_encode() | raw }};


                var data = new google.visualization.DataTable();

                data.addColumn('string', 'category');
                data.addColumn('number', 'amount');

                var row = [];

                categoryData.forEach(categoryRow => row.push([categoryRow.category, categoryRow.amount]));

                data.addRows(row);

                var options = {
                    'title': 'Summary of categorised spending',
                    'width': 800,
                    'height': 500
                };

                var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            }

        </script>

        <div class="govuk-width-container">
            <a href="/money_out_summary" class="govuk-back-link">Back</a>
            <main class="govuk-main-wrapper">
                <div class="govuk-grid-row">
                    <div class="govuk-grid-column-two-thirds">
                        <h1 class="govuk-heading-xl ">{{ title }} </h1>
                        <p class="govuk-body">Please find a summary of the following:</p>
                        <ul class="govuk-list govuk-list--bullet">
                            <li>Graph displaying categorised spending for this years submitted financial information.</li>
                            <li>Graph comparing year on year difference in categorised spending.</li>
                        </ul>

                        <h2 class="govuk-heading-l ">Categorised spending</h2>
                        <!--Div that will hold the pie chart-->
                        <div id="chart_div"></div>

                        <h2 class="govuk-heading-l ">Year on Year spending difference (if applicable)</h2>

                    </div>
                </div>
            </main>
        </div>

{% endblock %}
